extends layout

block content
  .container
    h3.bordered #{w.region} / #{w.realm} / guild: #{w.name}, level: #{w.armory.level} / members: #{w.armory.members?w.armory.members.length:'?'}
    if h
      div History available: #{h.length}
    div
      | View : 
      a(href='http://#{w.region}.battle.net/wow/en/guild/#{encodeURIComponent(w.realm)}/#{encodeURIComponent(w.name)}/') armory
      &nbsp;-&nbsp;
      a(href='http://#{p.region}.battle.net/api/wow/guild/#{encodeURIComponent(p.realm)}/#{encodeURIComponent(p.name)}?fields=members,achievements,news,challenge') api
      &nbsp;-&nbsp;
      a(href='/feed/#{w.type}/#{encodeURIComponent(w.region)}/#{encodeURIComponent(w.realm)}/#{encodeURIComponent(w.name)}.rss') rss
    .columns.sixteen.arial_narrow16.txt_center.margin_bot20
      if w.armory.members
        script(type='text/javascript')
          function charImgError(image){
          image.onerror = ""
          image.src = "http://eu.battle.net//wow/static/images/2d/avatar/1-1.jpg"
          return true;
          }

        each char in w.armory.members
          span(style="float:left")
            a(href='/view/member/#{encodeURIComponent(w.region)}/#{encodeURIComponent(w.realm)}/#{encodeURIComponent(char.character.name)}',title='#{char.character.name} (level #{char.character.level}, rank #{char.rank})')
              img(src='http://#{w.region}.battle.net/static-render/#{w.region}/#{char.character.thumbnail}',
                onerror='charImgError(this)',
                style='border:solid black 1px;')
              div= char.character.name
            &nbsp;
      else
        h3 No members found
      hr
      each item in f
        h5 #{item.title}
        div !{item.description}
        div #{item.date_formatted}
        div 
          a(href='#{item.url}') link
      hr
      each hist in h
        div CHANGE: #{hist.name} : #{fmtdate(hist.lastModified)} : #{JSON.stringify(hist.whats_changed)}

      // #{JSON.stringify(w)} 